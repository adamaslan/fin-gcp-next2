# Personal Identifiable Information (PII) Pattern Database
# For use with sensitive-data-scan skill
# Note: Context matters greatly - examples in docs may be INFO, real data in backups is WARNING/CRITICAL

patterns:
  email_address:
    name: "Email Address (Context-dependent)"
    regex: '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'
    severity: WARNING
    examples:
      - "user@example.com"
      - "john.doe@company.com"
      - "test_user_123@example.com"
    false_positives:
      - "user@example.com  # Example"
      - "@example.com"
      - "example@test.com"
      - ".env.example"
      - "admin@localhost"
      - "[EMAIL]"
      - "[USER]@[DOMAIN]"
    context_analysis:
      - "In .env.example: INFO"
      - "In documentation: INFO"
      - "In test results: INFO"
      - "In real data/backups: WARNING"
      - "In customer list: CRITICAL"
    remediation: "Verify context; redact if real customer data"
    risk: "Email compromise; spam targeting; identity theft (if PII)"

  us_phone_number:
    name: "US Phone Number"
    regex: '(\b1[-.]?\d{3}[-.]?\d{3}[-.]?\d{4}\b|\b\d{3}[-.]?\d{3}[-.]?\d{4}\b)'
    severity: WARNING
    examples:
      - "555-123-4567"
      - "555.123.4567"
      - "5551234567"
      - "+1-555-123-4567"
    false_positives:
      - "555-0100  # Example"
      - "555-HELP"
      - "[PHONE]"
    context:
      - "In documentation: INFO"
      - "In contact list: WARNING"
      - "In customer data: CRITICAL"
    remediation: "Verify context; redact if real customer phone"
    risk: "Unsolicited contact; phishing; identity fraud"

  international_phone:
    name: "International Phone Number"
    regex: '(\+\d{1,3}[-.\s]?\d{1,14}|\(\d{1,4}\)\s?\d{1,4}[-.\s]?\d{1,9})'
    severity: WARNING
    examples:
      - "+44 20 7123 1234"
      - "+86 10 1234 5678"
      - "+81-3-1234-5678"
    false_positives:
      - "+[CODE] [NUMBER]"
      - "[PHONE]"
    context:
      - "In documentation: INFO"
      - "In customer records: WARNING"
    remediation: "Verify if real phone; redact if customer data"
    risk: "Contact and identity information"

  us_social_security_number:
    name: "US Social Security Number (SSN)"
    regex: '\b(?!000|666)[0-6][0-9]{2}-(?!00)[0-9]{2}-(?!0000)[0-9]{4}\b'
    severity: CRITICAL
    examples:
      - "123-45-6789"
      - "987-65-4321"
    false_positives: []
    context:
      - "Should NEVER appear in code/docs"
    remediation: "Remove immediately; check for other SSNs"
    risk: "Identity theft; financial fraud; credit account opening"

  ssn_alternative_format:
    name: "Social Security Number (Alternative Formats)"
    regex: '\b\d{3}\s\d{2}\s\d{4}\b|\b\d{9}\b'
    severity: WARNING
    examples:
      - "123 45 6789"
      - "123456789"
    false_positives:
      - "[SSN]"
      - "Employee ID: 123456789  # 9-digit but not SSN"
    context:
      - "May be SSN in context of PII"
      - "May be employee/account number"
    remediation: "Verify if SSN; if so, redact completely"
    risk: "Identity theft if confirmed as SSN"

  us_drivers_license:
    name: "US Driver's License Number"
    regex: '\b[A-Z]{1,2}\d{5,7}\b|\b\d{5,7}[A-Z]{1,2}\b'
    severity: WARNING
    examples:
      - "CA12345678"
      - "NY1234567"
    false_positives:
      - "[LICENSE]"
    context:
      - "In customer identity records"
      - "KYC/AML compliance docs"
    remediation: "Redact driver's license numbers"
    risk: "Identity fraud; account takeover"

  credit_card_number:
    name: "Credit Card Number (Full or Partial)"
    regex: '\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12}|(?:2131|1800|35\d{3})\d{11})\b'
    severity: CRITICAL
    examples:
      - "4532-1234-5678-9010"
      - "5105105105105100"
      - "371449635398432"
    false_positives: []
    context:
      - "Should NEVER appear in code"
      - "Should NEVER appear in logs"
    remediation: "Remove immediately; audit for others"
    risk: "Payment card fraud; direct financial loss"

  passport_number:
    name: "Passport Number"
    regex: '\b[A-Z]{1,2}\d{6,9}\b'
    severity: WARNING
    examples:
      - "US12345678"
      - "GB1234567"
    false_positives:
      - "[PASSPORT]"
    context:
      - "In customer identity records"
      - "Travel records"
    remediation: "Redact passport numbers"
    risk: "Identity fraud"

  home_address:
    name: "Home Address (Street + City + State + ZIP)"
    regex: '\d+\s+[A-Za-z\s\.]+(?:Street|St|Avenue|Ave|Road|Rd|Drive|Dr|Lane|Ln|Boulevard|Blvd|Court|Ct),?\s+[A-Za-z\s]+,?\s+[A-Z]{2}\s+\d{5}'
    severity: WARNING
    examples:
      - "123 Main Street, Springfield, IL 60601"
      - "456 Oak Ave, Portland, OR 97201"
    false_positives:
      - "[ADDRESS]"
    context:
      - "In customer records"
      - "Shipping/billing addresses"
    remediation: "Redact if customer data"
    risk: "Physical location information; home address"

  credit_card_expiry:
    name: "Credit Card Expiration Date (Potential)"
    regex: '\b(?:0[1-9]|1[0-2])/\d{2}\b|\b(?:0[1-9]|1[0-2])-\d{2}\b'
    severity: INFO
    examples:
      - "12/25"
      - "03-26"
    false_positives:
      - "Multiple false positives with dates"
      - "[MM/YY]"
    context:
      - "Usually informational only"
      - "Unless with full card number"
    remediation: "Only critical if with card number"
    risk: "Low if standalone"

  cvv_number:
    name: "CVV/CVC Code (Credit Card Verification)"
    regex: '\bCVV?\s*[=:]\s*\d{3,4}\b|\b\d{3,4}\s+(CVV|CVC|Security Code)\b'
    severity: CRITICAL
    examples:
      - "CVV: 123"
      - "CVC = 4567"
    false_positives:
      - "CVV: [CODE]"
      - "[CVV]"
    context:
      - "With card data"
    remediation: "Remove immediately"
    risk: "Card fraud"

  bank_account_number:
    name: "Bank Account Number"
    regex: '\b(account|acct)\s*[#:]?\s*(\d{8,17})\b'
    severity: CRITICAL
    examples:
      - "account: 123456789012345"
      - "acct #: 98765432"
    false_positives:
      - "account = [ACCOUNT_NUMBER]"
      - "account: [ID]"
    context:
      - "In financial records"
      - "Banking information"
    remediation: "Remove immediately"
    risk: "Bank fraud; account compromise"

  routing_number:
    name: "Bank Routing Number (US)"
    regex: '\b(routing|rtn|aba)\s*[#:]?\s*(\d{9})\b'
    severity: WARNING
    examples:
      - "routing: 123456789"
      - "RTN: 987654321"
    false_positives:
      - "[ROUTING_NUMBER]"
    context:
      - "In wire transfer instructions"
      - "Banking setup"
    remediation: "Redact if combined with account number"
    risk: "Account identification information"

  ipv4_address:
    name: "IPv4 Address (Potential Internal Network)"
    regex: '\b(?:10|172\.(?:1[6-9]|2[0-9]|3[01])|192\.168)\.(?:\d{1,3}\.){2}\d{1,3}\b|\b127\.0\.0\.\d{1,3}\b|\b0\.0\.0\.0\b'
    severity: INFO
    examples:
      - "192.168.1.1"
      - "10.0.0.100"
      - "172.16.0.1"
      - "127.0.0.1"
    false_positives: []
    context:
      - "Internal network information"
      - "Usually not critical"
    remediation: "Redact if internal infrastructure"
    risk: "Network topology information"

  mac_address:
    name: "MAC Address"
    regex: '(?:[0-9A-Fa-f]{2}[:-]){5}(?:[0-9A-Fa-f]{2})'
    severity: INFO
    examples:
      - "00:1A:2B:3C:4D:5E"
      - "00-1A-2B-3C-4D-5E"
    false_positives: []
    context:
      - "Device identification"
      - "Network configuration"
    remediation: "Redact if device identification critical"
    risk: "Device tracking information"

  full_name_pattern:
    name: "Person Name (First + Last) - High Confidence"
    regex: '\b[A-Z][a-z]+\s+(?:van|von|de|del|della|di|da|le|la|bin|bin\s+)?\b[A-Z][a-z]+\b'
    severity: INFO
    examples:
      - "John Smith"
      - "Mary Johnson"
    false_positives:
      - "Many legitimate words match"
      - "[FIRST_NAME] [LAST_NAME]"
    context:
      - "Generic name format"
      - "Usually not critical alone"
    remediation: "Only critical if with other PII"
    risk: "Personal identification"

  date_of_birth:
    name: "Date of Birth (Potential)"
    regex: '\b(DOB|Date of Birth|Birth Date)\s*[=:]\s*(\d{1,2}[-/]\d{1,2}[-/]\d{2,4})\b'
    severity: WARNING
    examples:
      - "DOB: 12/25/1990"
      - "Date of Birth = 1990-12-25"
    false_positives:
      - "[DOB]"
      - "date: [YYYY-MM-DD]"
    context:
      - "In customer records"
      - "KYC information"
    remediation: "Redact if customer data"
    risk: "Identity information"

  government_id:
    name: "Government ID Reference"
    regex: '\b(ID|Employee ID|Student ID|Government ID)\s*[#:]?\s*([A-Z0-9]{6,12})\b'
    severity: WARNING
    examples:
      - "Government ID: ABC123456"
      - "Employee ID: EMP987654"
    false_positives:
      - "[ID]"
      - "Employee ID: [ID]"
    context:
      - "In personnel records"
      - "Identification system"
    remediation: "Verify if sensitive; redact if real ID"
    risk: "Identity information"

